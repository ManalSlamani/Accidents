{% extends 'home/welcome.html' %}
{% block page_name %} Tableau de bord {% endblock %}
{% load static %}
    <script src="{% static 'js/code/modules/exporting.js' %}"></script>
<script src="{% static 'js/code/modules/offline-exporting.js' %}"></script>
<script src="{% static 'js/code/modules/export-data.js' %}"></script>
<script src="{% static 'js/code/modules/accessibility.js' %}"></script>

{% block content %}

    <style>
table {
  font-family: courier-new, courier, monospace, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
    font-family: courier-new, courier, monospace, sans-serif;
  border: 1px solid #dddddd;
  text-align: left;
  height: 15px  ;
  padding: 4px;
}

</style>


    <div class="container-fluid">
        <div style="  border-left-style: solid; border-width: 2px; border-color: #34495e">
            <h4 style="padding-left: 4px"> Prédiction de futures accidents routiers en Algérie</h4>
        </div>
        <div class="row">
            <div class="col-lg-7">
{#                 <h5 style="border-left-style: groove; padding-left: 3px ">Réulatats du prédicteur "Forets aléatoires"</h5>#}
                 <p style="float: right">Total: {{ total }} accidents prédits pour le {{ mars.date.1.date }}</p>
                <table class="table table-bordered" style="padding-top: 20px; width: 100%; font-size: 12.5px; width: 100%"  >
  <thead>
    <tr class="table-warning">
        <th>#</th>
        <th>Wilaya</th>
      <th >Latitude</th>
      <th >Longitude</th>
      <th>Date</th>
      <th >Heure</th>
      <th>Probabillité</th>
    </tr>
  </thead>

  <tbody>
  <font size="5">
   {% for acc in mars.itertuples %}
       <tr>
           <td > <a href="acc.Index">{{acc.Index}}</a></td>
       <td>{{ acc.wilaya }}</td>
       <td>{{ acc.Latitude|floatformat:4 }}</td>
       <td>{{ acc.Longitude|floatformat:4 }}</td>
       <td>{{ acc.date.date }}</td>
       <td>{{ acc.HEURE }}</td>
       <td>{{ acc.proba_1|floatformat:4}}</td>
       </tr>
   {% endfor %}
   </font>
  </tbody>
</table>
            </div>
            <div class="col-lg-5">
            <div style="border-style: groove; width: 100%; align-content: center">  {{my_map|safe}} </div><br>
            </div>
        </div>
        <div style="padding-top: 20px">

        </div>
    </div>
<script>
function humanize(x){
  return x.toFixed(4).replace(/\.?0*$/,'');
}


$(document).ready(function(){
    $('[data-toggle="popover"]').popover();
});


Highcharts.chart('predictionchart', {
    chart: {
        type: 'column'
    },
    title: {
        text: 'Accidents prédits avec leur probabilité d\'occurrence',
    },

    xAxis: {
        categories:[
            {% for entry in mars %}{{ entry.date}} {% if not forloop.last %}, {% endif %}{% endfor %}

        ],
        title: {
            text: 'Date'}
    },

    yAxis:{
        title: {
            text: 'Probabilité'}
    },
    legend: {
        enabled: false,
    },

    series: [
        {   color: '#c0392b',
            data: [
                {% for entry in mars %}{{ entry.proba_1}}{% if not forloop.last %}, {% endif %}{% endfor %}

        ],
             accessibility: {
            exposeAsGroupOnly: true
        },
            }]
});


</script>


{% endblock %}